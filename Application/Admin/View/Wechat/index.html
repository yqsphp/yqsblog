<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<include file="Public/alert" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="__PUBLIC__/css/bootstrap.min.css">
<link rel="stylesheet" href="__PUBLIC__/zTreeStyle/zTreeStyle.css">
<!-- 自定义样式 -->
<link rel="stylesheet" href="__PUBLIC__/admin/css/wx-custom.css">
</head>
<div class="panel admin-panel">
	<div class="panel-head">
		<strong class="glyphicon glyphicon-align-justify"> 自定义菜单</strong>
	</div>
	<div class="custom-menu-edit-con">
		<div class="hbox">
			<div class="inner-left">
				<div class="custom-menu-view-con">
					<div class="custom-menu-view">
						<div class="custom-menu-view__title"><{$get.title}></div>
						<div class="custom-menu-view__body">
							<div class="weixin-msg-list">
								<ul class="msg-con">
								</ul>
							</div>
						</div>
						<div id="menuMain" class="custom-menu-view__footer">
							<div class="custom-menu-view__footer__left">
							</div>
							<div class="custom-menu-view__footer__right">
								<!--<div class="custom-menu-view__menu f_1" fid="f_1" x="1" y="0">
									<div class="text-ellipsis custom-menu-view_first">
										<i type="1" class="custom-menu-close glyphicon glyphicon-remove" style="display: none;"></i>
										<i class='glyphicon glyphicon-plus text-info iBtn'></i>
										<span id="f_1"></span>
									</div>
									<ul class="custom-menu-view__menu__sub">
										<li class="custom-menu-view__menu__sub__add custom-menu-view_second">
											<div class="text-ellipsis">
												<i class="glyphicon glyphicon-plus text-info"></i>
											</div>
										</li>
									</ul>
								</div>
								<div class="custom-menu-view__menu f_2" fid="f_2" x="2" y="0">
									<div class="text-ellipsis custom-menu-view_first">
										<i type="1" class="custom-menu-close glyphicon glyphicon-remove" style="display: none;"></i>
										<i class="glyphicon glyphicon-plus text-info iBtn"></i>
										<span id="f_2"></span>
									</div>
									<ul class="custom-menu-view__menu__sub">
										<li class="custom-menu-view__menu__sub__add custom-menu-view_second">
											<div class="text-ellipsis">
												<i class="glyphicon glyphicon-plus text-info"></i>
											</div>
										</li>
									</ul>
								</div>
								<div class="custom-menu-view__menu f_3" fid="f_3" x="3" y="0">
									<div class="text-ellipsis custom-menu-view_first">
										<i type="1" class="custom-menu-close glyphicon glyphicon-remove" style="display: none;"></i>
										<i class="glyphicon glyphicon-plus text-info iBtn"></i>
										<span id="f_3"></span>
									</div>
									<ul class="custom-menu-view__menu__sub">
										<li class="custom-menu-view__menu__sub__add custom-menu-view_second">
											<div class="text-ellipsis">
												<i class="glyphicon glyphicon-plus text-info"></i>
											</div>
										</li>
									</ul>
								</div>-->
								<volist name="pinfo" id="v" key="k">
								<div class="custom-menu-view__menu f_<{$k}>" fid="f_<{$k}>" x="<{$k}>" y="0">
									<div class="text-ellipsis custom-menu-view_first" id="<{$v.id}>">
										<i type="1" class="custom-menu-close glyphicon glyphicon-remove"></i>
										<i class='glyphicon glyphicon-plus text-info iBtn' style="display: none;"></i>
										<span id="f_<{$k}>"><{$v.name}></span>
									</div>
									<ul class="custom-menu-view__menu__sub">
										<volist name="cinfo" id="vo" key="ko">
											<if condition="$vo['pid'] eq $v['id']">
											<li class="custom-menu-view__menu__sub__add custom-second" id="<{$vo.id}>" x="<{$vo.x}>" y="<{$vo.y}>" fid="sub_f_<{$k}>_<{$vo.y}>">
												<div id="sub_f_<{$k}>_<{$vo.y}>" class="text-ellipsis"><{$vo.name}></div>
												<i class="custom-menu-close glyphicon glyphicon-remove"></i>
											</li>	
											</if>
										</volist>
										<li class="custom-menu-view__menu__sub__add custom-menu-view_second">
											<div class="text-ellipsis">
												<i class="glyphicon glyphicon-plus text-info"></i>
											</div>
										</li>
									</ul>
								</div>
								</volist>
								<for start="$plength+1" end="4">
								<div class="custom-menu-view__menu f_<{$i}>" fid="f_<{$i}>" x="<{$i}>" y="0">
									<div class="text-ellipsis custom-menu-view_first" id="">
										<i type="1" class="custom-menu-close glyphicon glyphicon-remove" style="display: none;"></i>
										<i class="glyphicon glyphicon-plus text-info iBtn"></i>
										<span id="f_<{$i}>"></span>
									</div>
									<ul class="custom-menu-view__menu__sub">
										<li class="custom-menu-view__menu__sub__add custom-menu-view_second">
											<div class="text-ellipsis">
												<i class="glyphicon glyphicon-plus text-info"></i>
											</div>
										</li>
									</ul>
								</div>
								</for>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="inner-right">
				<div class="cm-edit-before"><h5>点击左侧菜单进行操作</h5></div>
				<div class="cm-edit-after" style="display: none;">
					<form id="custom-submit" class="form-horizontal wrapper-md" name="custom_form">
						<input type="hidden" name="token" id="" value="<{$get.token}>" />
						<input type="hidden" name="id" id="id" value="" />
						<input type="hidden" name="pid" id="pid" value="" />
						<input type="hidden" name="x" id="x" value="0" />
						<input type="hidden" name="y" id="y" value="0" />
						<input type="hidden" name="replytype" id="replytype" value="1" />
						<div class="form-group">
							<label class="col-sm-2 control-label">菜单名称:</label>
							<div class="col-sm-5">
								<input name="name" fid="" type="text" class="form-control custom_input_title" value="" placeholder="请输入标题">
							</div>
							<div class="col-sm-5 help-block">
								<div>
									一级菜单字数不超过5个汉字<br />
									二级菜单字数不超过8个汉字
								</div>
							</div>
						</div>
						<div class="form-group" id="radioGroup">
							<label class="col-sm-2 control-label">菜单内容:</label>
							<div class="col-sm-10 LebelRadio">
								<label class="checkbox-inline"><input type="radio" name="sendtype" value="1" checked> 发送消息</label>
								<label class="checkbox-inline"><input type="radio" name="sendtype" value="2"> 跳转网页</label>
							</div>
						</div>
						<div id="editContent">
							<div class="cm-edit-content-con" id="editMsg">
								<div class="editTab">
									<div class="editTab-heading">
										<ul class="msg-panel__tab">
											<li class="msg-tab_item active">
												<span class="glyphicon glyphicon-list-alt" type="1"></span> 图文
											</li>
											<li class="msg-tab_item on">
												<span class="glyphicon glyphicon-edit" type="1"></span> 文本
											</li>
											<!--<li class="msg-tab_item on">
												<span class="glyphicon glyphicon-picture" type="1"></span> 图片
											</li>-->
										</ul>
									</div>
									<input type="hidden" name="type" id="custom-type" value="1"/>
									<input type="hidden" name="aid" id="aid" value=""/>
									<input type="hidden" name="tablename" id="tablename" value=""/>
									<div class="editTab-body">
										<div style="display: block;">
											<ul id="treeDemo" class="ztree select"></ul>
										</div>
										<div>
											<textarea class="textcon" id="conts" name="text" placeholder="请输入文本内容"></textarea>
											<div id="emotion"></div>
										</div>
										<!--<div>这里是图片区</div>-->
									</div>
								</div>
							</div>
							<div class="cm-edit-content-con" id="editPage" style="display: none;">
								<div class="cm-edit-page">
									<div class="row">
										<label class="col-sm-6 control-label">点击该菜单会跳转到以下链接:
										</label>
									</div>
									<div class="row">
										<label class="col-sm-2 control-label">页面地址:
										</label>
										<div class="col-sm-8">
											<input type="text" name="links" class="form-control links" placeholder="输入地址">
											<span class="help-block">如：http://www.xxx.com</span>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="cm-edit-footer">
							<button id="saveBtns" type="button" class="btn btn-info"><i class="glyphicon glyphicon-check"></i> 保存</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="custom-publish">
		<button class="btn btn-success" id="publish"><i class="glyphicon glyphicon-send"></i> 发布</button>
		编辑完成后请点击发布按钮
	</div>
</div>
</body>
<script src="__PUBLIC__/js/jquery-1.10.2.min.js"></script>
<script src="__PUBLIC__/js/bootstrap.min.js"></script>

<!--树形-->
<script src="__PUBLIC__/zTreeStyle/jquery.ztree.core.js"></script>
<script src="__PUBLIC__/zTreeStyle/jquery.ztree.excheck.js"></script>

<script src="__PUBLIC__/admin/js/wechatmenu.min.js"></script>
<include file="Public/emoji" />
<script type="text/javascript">
$(function(){
	$("#publish").click(function(){
		$.ajax({
			type:"post",
			url:"<{:U('wechatApp/publish')}>",
			data:{"token":"<{$get.token}>","id":<{$get.id}>},
			beforeSend:loading(),
			success:function(data){
				console.log(data);
				if(data.code == 200){
					success(data.message);
				}else{
					errors(data.code+'<br>'+data.message);
				}
				console.log(data);
			}
		});
	});
});
</script>
</html>